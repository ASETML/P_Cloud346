<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.2.7">
  <diagram id="a6cbLUU-jB-zKC2NW-jB" name="Page-1">
    <mxGraphModel dx="3565" dy="1878" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="2" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Utilisateur" vertex="1">
          <mxGeometry height="1578" width="150" as="geometry" />
        </mxCell>
        <mxCell id="3" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Frontend" vertex="1">
          <mxGeometry height="1578" width="150" x="316" as="geometry" />
        </mxCell>
        <mxCell id="4" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Microsoft" vertex="1">
          <mxGeometry height="1578" width="150" x="600" as="geometry" />
        </mxCell>
        <mxCell id="5" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Backend" vertex="1">
          <mxGeometry height="1578" width="150" x="1122" as="geometry" />
        </mxCell>
        <mxCell id="6" parent="1" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;container=1;dropTarget=0;collapsible=0;recursiveResize=0;outlineConnect=0;portConstraint=eastwest;newEdgeStyle={&quot;edgeStyle&quot;:&quot;elbowEdgeStyle&quot;,&quot;elbow&quot;:&quot;vertical&quot;,&quot;curved&quot;:0,&quot;rounded&quot;:0};size=65;fontSize=14;" value="Database" vertex="1">
          <mxGeometry height="1578" width="150" x="1370" as="geometry" />
        </mxCell>
        <mxCell id="7" parent="1" style="shape=umlFrame;dashed=1;pointerEvents=0;dropTarget=0;strokeColor=#B3B3B3;height=20;width=30;fontSize=14;" value="alt" vertex="1">
          <mxGeometry height="98" width="270" x="1186" y="625" as="geometry" />
        </mxCell>
        <mxCell id="8" parent="7" style="text;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;fontSize=14;" value="[Utilisateur n&#39;existe pas]" vertex="1">
          <mxGeometry height="20" width="240" x="30" as="geometry" />
        </mxCell>
        <mxCell id="9" edge="1" parent="1" source="2" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="3" value="Clique sur « Login avec Microsoft »">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="242" y="107" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="10" edge="1" parent="1" source="3" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="4" value="Redirige vers /auth/msal/login">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="542" y="159" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="11" edge="1" parent="1" source="4" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="2" value="Affiche la page de login">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="387" y="211" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="12" edge="1" parent="1" source="2" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="4" value="Saisit identifiants et accepte les scopes (zones d&#39;accès)">
          <mxGeometry relative="1" x="0.0007" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="384" y="263" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="13" edge="1" parent="1" source="4" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="5" value="Redirection vers /auth/msal/callback?code=XXX">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="945" y="315" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="14" edge="1" parent="1" source="5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="4" value="Échange code via POST /token">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="948" y="367" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="15" edge="1" parent="1" source="4" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="5" value="Retourne access_token et id_token">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="945" y="419" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="16" edge="1" parent="1" source="5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="4" value="Appelle https://graph.microsoft.com/v1.0/me avec access_token">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="948" y="471" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="17" edge="1" parent="1" source="5" style="curved=1;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="5" value="Obtient id, displayName, mail">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1248" y="523" />
              <mxPoint x="1248" y="553" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="18" edge="1" parent="1" source="5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="6" value="Vérifie si utilisateur existe">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1330" y="605" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="19" edge="1" parent="1" source="5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="6" value="Crée nouvel utilisateur">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1330" y="703" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="20" edge="1" parent="1" source="5" style="curved=1;endArrow=block;fontSize=14;" target="5" value="Génère un JWT valable 24h">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1248" y="765" />
              <mxPoint x="1248" y="795" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="21" edge="1" parent="1" source="5" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;dashed=1;dashPattern=2 3;endArrow=block;fontSize=14;" target="3" value="Retourne access_token, id_token, jwt, user">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="806" y="847" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="22" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Stocke jwt dans localStorage">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="899" />
              <mxPoint x="442" y="929" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="23" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Met à jour l&#39;état réactif">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="981" />
              <mxPoint x="442" y="1011" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="24" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Utilise JWT pour toutes les requêtes internes">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="1063" />
              <mxPoint x="442" y="1093" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="25" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Détecte si utilisateur est connecté">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="1145" />
              <mxPoint x="442" y="1175" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="26" edge="1" parent="1" source="2" style="verticalAlign=bottom;edgeStyle=elbowEdgeStyle;elbow=vertical;curved=0;rounded=0;endArrow=block;fontSize=14;" target="3" value="Appelle logout()">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="242" y="1227" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="27" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Supprime msJwt, token, currentUserId">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="1279" />
              <mxPoint x="442" y="1309" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="28" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="Met à jour l&#39;état réactif">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="1361" />
              <mxPoint x="442" y="1391" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="29" edge="1" parent="1" source="3" style="curved=1;endArrow=block;fontSize=14;" target="3" value="UI revient à l’état « non connecté »">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="442" y="1443" />
              <mxPoint x="442" y="1473" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="oV3SfN3ZfyzmeW76MRq7-29" parent="1" style="text;whiteSpace=wrap;fontStyle=0;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=16;" value="Scopes: Utilisateur autorise l&#39;application à recevoir ces données et à maintenir une session d&#39;autorisation.&#xa;&#xa;MSAL (Microsoft Authentication Library) : Bibliothèque utilisée pour gérer la connexion via Microsoft OAuth2. Elle facilite la récupération des tokens, la gestion des sessions et l’intégration avec Azure AD.&#xa;&#xa;LocalStorage synchronisé avec Vue : Mécanisme permettant de stocker les tokens côté client et de mettre à jour automatiquement les composants Vue lorsque l’état de connexion change.&#xa;&#xa;Access Token : Token temporaire utilisé pour authentifier les requêtes de l’application vers l’API. Il est fourni par Microsoft après l’autorisation de l’utilisateur.&#xa;" vertex="1">
          <mxGeometry height="380" width="880" y="1578" as="geometry" />
        </mxCell>
        <mxCell id="oV3SfN3ZfyzmeW76MRq7-30" parent="1" style="text;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" value="&lt;p data-start=&quot;1796&quot; data-end=&quot;1856&quot;&gt;&lt;/p&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;strong data-start=&quot;1796&quot; data-end=&quot;1818&quot; style=&quot;font-size: 20px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Flux OAuth2 / MSAL&lt;/strong&gt;&lt;span style=&quot;font-size: 20px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt; :&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;&quot;&gt;&lt;div style=&quot;text-align: center;&quot;&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;font-size: 20px;&quot;&gt;&lt;div style=&quot;text-align: justify;&quot;&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Processus en plusieurs étapes :&lt;/span&gt;&lt;/div&gt;&lt;/span&gt;&lt;/font&gt;&lt;p&gt;&lt;/p&gt;&lt;ol data-start=&quot;1857&quot; data-end=&quot;2205&quot;&gt;&lt;li data-start=&quot;1857&quot; data-end=&quot;1903&quot;&gt;&lt;p data-start=&quot;1860&quot; data-end=&quot;1903&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Redirection vers la page Microsoft login.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;1904&quot; data-end=&quot;1959&quot;&gt;&lt;p data-start=&quot;1907&quot; data-end=&quot;1959&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Saisie des identifiants et acceptation des scopes.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;1960&quot; data-end=&quot;2011&quot;&gt;&lt;p data-start=&quot;1963&quot; data-end=&quot;2011&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Retour au backend avec un code d’autorisation.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;2012&quot; data-end=&quot;2071&quot;&gt;&lt;p data-start=&quot;2015&quot; data-end=&quot;2071&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Échange du code contre un Access Token et un ID Token.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;2072&quot; data-end=&quot;2130&quot;&gt;&lt;p data-start=&quot;2075&quot; data-end=&quot;2130&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Création de l’utilisateur MSAL en base si inexistant.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;li data-start=&quot;2131&quot; data-end=&quot;2205&quot;&gt;&lt;p data-start=&quot;2134&quot; data-end=&quot;2205&quot; style=&quot;text-align: justify;&quot;&gt;&lt;font style=&quot;font-size: 20px;&quot;&gt;Génération d’un JWT interne pour authentification dans l’application.&lt;/font&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;" vertex="1">
          <mxGeometry height="378" width="664" x="989" y="1580" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
